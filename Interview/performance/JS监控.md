# 为什么要做性能监控
谷歌将页面加载速度作为一个重要的SEO权重

# 可以做性能监控的点
- 白屏时间
- 首屏时间
- 用户可操作时间
- 总下载时间
---------------------------------------- 
- 白屏时间指**head内资源**加载完成
- 首屏时间指**可视区域内最后一张图片加载完成**的时间
- 可操作时间指**Document.onready**时间
- 总下载时间指**Document.onload**时间
# 白屏时间
白屏时间是**用户首次看到内容的时间**，也叫做**首次渲染时间**，chrome 高版本有**firstPaintTime**接口来获取这个耗时，但大部分浏览器并不支持，必须想其他办法来监测。仔细观察 WebPagetest 视图分析发现，白屏时间出现在**头部外链资源加载完附近**，因为浏览器只有加载并解析完头部资源才会真正渲染页面。基于此我们可以通过获取头部资源加载完的时刻来近似统计白屏时间

```
<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="UTF-8"/>
    <script>
      var start_time = +new Date; //测试时间起点，实际统计起点为 
    </script>
    <script src="js"></script>  
    <script>
      var end_time = +new Date; //时间终点
      var headtime = end_time - start_time; //头部资源加载时间    
      console.log(headtime);
    </script>
</html>
```
# 首屏时间
首屏时间的统计比较复杂，因为涉及图片等多种元素及异步渲染等方式。观察加载视图可发现，影响首屏的主要因素的**图片的加载**。通过统计首屏内图片的加载时间便可以获取首屏渲染完成的时间。统计流程如下

首屏位置调用 API 开始统计 -> 
**绑定首屏内所有图片的 load 事件** -> 页面加载完后判断图片是否在首屏内，找出加载最慢的一张 ->
首屏时间

# 可操作时间
用户可操作默认可以统计**domready**  时间，因为通常会在这时候绑定事件操作。对于使用了模块化异步加载的 JS 可以在代码中去主动标记重要 JS 的加载时间，这也是产品指标的统计方式

# 总下载时间
总下载时间默认可以统计onload时间，这样可以统计同步加载的资源全部加载完的耗时。如果页面中存在很多异步渲染，可以将异步渲染全部完成的时间作为总下载时间

## document.ready和window.onload的区别
document.ready和window.onload的区别——JavaScript文档加载完成事件。
页面加载完成有两种事件：
一是ready，表示文档结构已经加载完成（不包含图片等非文字媒体文件）。
二是onload，指示页面包含图片等文件在内的所有元素都加载完成。

## 为什么要使用document.ready()或者document.onload()
$(document).ready() 里的代码是在页面内容都加载完才执行的，如果把代码直接写到script标签里，当页面加载完这个script标签就会执行里边的代码了，此时如果你标签里执行的代码调用了当前还没加载过来的代码或者dom，那么就会报错，当然如果你把script标签放到页面最后面那么就没问题了，此时和ready效果一样。