## 什么是React的事件机制
- React 基于浏览器的事件机制自身实现了一套事件机制，包括事件注册、事件的合成、事件冒泡、事件派发等；在 React 中这套事件机制被称之为合成事件（Synthetic Event）
- 合成事件是 React 模拟原生 DOM 事件所有能力的一个事件对象，即浏览器原生事件的跨浏览器包装器
- 根据 W3C 规范来定义合成事件，兼容所有浏览器，拥有与浏览器原生事件相同的接口

## 使用合成事件的优势
1. 减少内存消耗，提升性能，不需要注册那么多的事件了，一种事件类型只在 document 上注册一次 
2. 统一规范，解决 ie 事件兼容问题（attachEvent），简化事件逻辑 
3. 对开发者友好，对原生事件进行封装

## 执行顺序
- React 所有事件都挂载在 document 对象上
- 当真实 DOM 元素触发事件，会冒泡到 document 对象后，再处理 React 事件
- 所以会先执行原生事件，然后处理 React 事件
- 最后真正执行 document 上挂载的事件

## 如何阻止不同时间段的冒泡行为
- 阻止合成事件间的冒泡，用 e.stopPropagation()
- 阻止合成事件与最外层 document 上的事件间的冒泡，用 e.nativeEvent.stopImmediatePropagation()
- 阻止合成事件与最外层 document 上的原生事件上的冒泡，通过判断 e.target 来避免

## 事件注册机制
1. 事件注册
组件挂载阶段，根据组件内的声明的事件类型-onclick，onchange 等，给 document 上添加事件 -addEventListener，并指定统一的事件处理程序 dispatchEvent。

2. 事件存储
就是把 react 组件内的所有事件统一的存放到一个对象里，缓存起来，为了在触发事件的时候可以查找到对应的方法去执行。

a. 完成事件注册
b. 将 react dom ，事件类型，处理函数 fn 放入数组存储
c. 组件挂载完成后，处理 b 步骤生成的数组，经过遍历把事件处理函数存储到 listenerBank(一个对象)中

## 事件执行机制
在事件注册阶段，最终所有的事件和事件类型都会保存到```listenerBank```中;
1. 进入统一的事件分发函数(dispatchEvent)
2. 结合原生事件找到当前节点对应的 ReactDOMComponent 对象
3. 开始 事件的合成
3.1 根据当前事件类型生成指定的合成对象
3.2 封装原生事件和冒泡机制
3.3 查找当前元素以及他所有父级
3.4 在 listenerBank 查找事件回调并合成到 event(合成事件结束)
4. 批量处理合成事件内的回调事件（事件触发完成 end）

